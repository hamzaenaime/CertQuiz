<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Portal - CertQuiz</title>
    <link rel="stylesheet" href="css/admin-styles.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

</head>
<body>
    <!-- Login Form -->
    <div id="login-container">
        <div class="login-box">
            <h1>üîê Admin Portal</h1>
            <p>Sign in to manage comments</p>
            <div class="input-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Enter username">
            </div>
            <div class="input-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter password">
            </div>
            <button class="login-btn" onclick="login()">Sign In</button>
            <div class="error-message" id="error-message">Invalid credentials</div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" style="display: none;">
        <div class="admin-container">
            <div class="admin-header">
                <h1>üìä Admin Dashboard</h1>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>

            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="tab-btn active" onclick="switchTab('comments')">üí¨ Comments</button>
                <button class="tab-btn" onclick="switchTab('questions')">üìù Questions</button>
            </div>

            <!-- Comments Tab -->
            <div id="comments-tab" class="tab-content active">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="total-comments">0</div>
                        <div class="stat-label">Total Comments</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-questions-discussed">0</div>
                        <div class="stat-label">Questions Discussed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="anonymous-comments">0</div>
                        <div class="stat-label">Anonymous Comments</div>
                    </div>
                </div>

                <div class="comments-container">
                    <h2>Manage Comments</h2>

                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="Search comments by text, author, or question ID..." oninput="filterComments()">
                    </div>

                    <div class="filters">
                        <button class="filter-btn active" onclick="filterByType('all')">All Comments</button>
                        <button class="filter-btn" onclick="filterByType('anonymous')">Anonymous Only</button>
                        <button class="filter-btn" onclick="filterByType('named')">Named Only</button>
                        <button class="filter-btn" onclick="filterByType('positive')">Positive Votes</button>
                        <button class="filter-btn" onclick="filterByType('negative')">Negative Votes</button>
                    </div>

                    <div id="admin-comments-list" class="loading">
                        Loading comments...
                    </div>
                </div>
            </div>

            <!-- Questions Tab -->
            <div id="questions-tab" class="tab-content">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="total-questions-db">0</div>
                        <div class="stat-label">Total Questions in DB</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="architect-questions">0</div>
                        <div class="stat-label">Data Architect</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="cloud-questions">0</div>
                        <div class="stat-label">Data Cloud</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="integration-questions">0</div>
                        <div class="stat-label">Integration</div>
                    </div>
                </div>

                <div class="comments-container">
                    <h2>Manage Questions</h2>

                    <div class="search-box">
                        <input type="text" id="question-search-input" placeholder="Search questions..." oninput="filterQuestions()">
                    </div>

                    <div class="filters" style="margin-bottom: 15px;">
                        <button class="filter-btn active" onclick="filterQuestionsByTopic('all')">All Topics</button>
                        <button class="filter-btn" onclick="filterQuestionsByTopic('architect')">Data Architect</button>
                        <button class="filter-btn" onclick="filterQuestionsByTopic('cloud')">Data Cloud</button>
                        <button class="filter-btn" onclick="filterQuestionsByTopic('integration')">Integration</button>
                    </div>

                    <div class="form-group" style="max-width: 300px; margin-bottom: 20px;">
                        <label for="question-sort">Sort By:</label>
                        <select id="question-sort" onchange="sortQuestions()">
                            <option value="number">Question Number (Default)</option>
                            <option value="most-voted">Most Voted Comments First</option>
                            <option value="latest-comments">Latest Comments First</option>
                            <option value="most-comments">Most Comments First</option>
                            <option value="no-comments">No Comments First</option>
                            <option value="recent-updated">Recently Updated</option>
                            <option value="recent-created">Recently Created</option>
                        </select>
                    </div>

                    <div id="admin-questions-list" class="loading">
                        Loading questions...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Question Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è Edit Question</h2>
                <button class="close-modal" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-question-form">
                    <input type="hidden" id="edit-question-id">

                    <div class="form-group">
                        <label for="edit-topic">Topic</label>
                        <select id="edit-topic">
                            <option value="architect">Data Architect</option>
                            <option value="cloud">Data Cloud</option>
                            <option value="integration">Integration</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="edit-question-text">Question Text</label>
                        <textarea id="edit-question-text" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Answer Options</label>
                        <div class="answers-grid">
                            <div class="answer-input-group">
                                <span class="answer-letter-label">A)</span>
                                <input type="text" id="edit-answer-a" required>
                            </div>
                            <div class="answer-input-group">
                                <span class="answer-letter-label">B)</span>
                                <input type="text" id="edit-answer-b" required>
                            </div>
                            <div class="answer-input-group">
                                <span class="answer-letter-label">C)</span>
                                <input type="text" id="edit-answer-c">
                            </div>
                            <div class="answer-input-group">
                                <span class="answer-letter-label">D)</span>
                                <input type="text" id="edit-answer-d">
                            </div>
                            <div class="answer-input-group">
                                <span class="answer-letter-label">E)</span>
                                <input type="text" id="edit-answer-e">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Correct Answer(s)</label>
                        <div class="correct-answer-selector" id="correct-answer-checkboxes">
                            <label>
                                <input type="checkbox" name="correct-answer" value="a">
                                <span>A</span>
                            </label>
                            <label>
                                <input type="checkbox" name="correct-answer" value="b">
                                <span>B</span>
                            </label>
                            <label>
                                <input type="checkbox" name="correct-answer" value="c">
                                <span>C</span>
                            </label>
                            <label>
                                <input type="checkbox" name="correct-answer" value="d">
                                <span>D</span>
                            </label>
                            <label>
                                <input type="checkbox" name="correct-answer" value="e">
                                <span>E</span>
                            </label>
                        </div>
                        <div class="form-hint">Select one or multiple correct answers</div>
                    </div>

                    <div class="form-group">
                        <label for="edit-explanation">Explanation</label>
                        <textarea id="edit-explanation" required></textarea>
                        <div class="form-hint">Explain why the answer is correct</div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="edit-multiselect">
                            <label for="edit-multiselect">This is a multi-select question</label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveQuestion()">üíæ Save Changes</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/admin.js"></script>
</body>
</html>
